"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[58209],{337148:function(e){var t,i,n={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StelaOnIdeaPinPermissionQuery",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"v3GetCurrentUserHandlerQuery",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"data",plural:!1,selections:[t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"ipStelaRecDisabled",storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],type:"V3GetCurrentUserHandler",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"StelaOnIdeaPinPermissionQuery",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"v3GetCurrentUserHandlerQuery",plural:!1,selections:[i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"data",plural:!1,selections:[i,t,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Node",abstractKey:"__isNode"}],storageKey:null}],type:"V3GetCurrentUserHandler",abstractKey:null}],storageKey:null}]},params:{id:"2653a6ed13b2a48a0adbce54781b1b88b025b8bd93a112b8a0bd15da606dcbe9",metadata:{},name:"StelaOnIdeaPinPermissionQuery",operationKind:"query",text:null}};n.hash="c061d1400492f868408772f86f659738",e.exports=n},916062:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(53987),o=i(609500);function l(e){var t=(0,o.useLocation)(),i=(0,o.useParams)(),l=(0,o.useHistory)();return function(){if(e&&(0,n.L6)(t)&&i.id===e.id){var o,a,s,r,d="quick_saves"===(null===(o=e.board)||void 0===o?void 0:o.layout)||"quick_creates"===(null===(a=e.board)||void 0===a?void 0:a.layout)?"/me/":null!==(s=null===(r=e.board)||void 0===r?void 0:r.url)&&void 0!==s?s:"/";l.replace(d)}}}},274495:function(e,t,i){i.d(t,{Z:function(){return s}});var n=i(908390),o=i(515198),l={__style:{margin:"0 10px",borderRight:"3px solid transparent",borderTop:"3px solid #fff",animation:"spin .8s linear infinite"}};function a(){return(0,o.jsx)(n.xu,{alignItems:"center",color:"primary",display:"flex",height:"100%",justifyContent:"center",position:"absolute",width:"100%",rounding:8,children:(0,o.jsx)(n.xu,{dangerouslySetInlineStyle:l,display:"inlineBlock",height:18,position:"relative",rounding:"circle",width:18})})}function s(e){var t=e.disabled,i=e.name,l=e.onClick,s=e.size,r=e.submitting,d=e.text;return(0,o.jsxs)(n.xu,{display:"flex",position:"relative",children:[r&&(0,o.jsx)(a,{}),(0,o.jsx)(n.zx,{color:"red",disabled:t||r,name:i,onClick:l,size:s,type:"submit",text:d})]})}},482567:function(e,t,i){i.d(t,{_:function(){return d}});var n=i(214494);function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(e,t,i,n,o,l,a){try{var s=e[l](a),r=s.value}catch(d){return void i(d)}s.done?t(r):Promise.resolve(r).then(n,o)}function r(e,t){return{type:"PIN_NOTE_UPDATE",payload:{pinId:e,pinNote:t}}}function d(e,t,i,o){return function(){var a,d=(a=regeneratorRuntime.mark((function a(s){var d,c,u;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(d=n.Z.create("ApiResource",{url:"/v3/pins/".concat(e,"/notes/"),data:l({pin_note_content:i},o?{orbac_subject_id:o}:Object.freeze({}))}),!i){a.next=13;break}if(!t){a.next=8;break}return a.next=5,d.callUpdate();case 5:c=a.sent,a.next=11;break;case 8:return a.next=10,d.callCreate();case 10:c=a.sent;case 11:a.next=16;break;case 13:return a.next=15,d.callDelete();case 15:c=a.sent;case 16:u=c.resource_response,s(r(e,null==u?void 0:u.data));case 18:case"end":return a.stop()}}),a)})),function(){var e=this,t=arguments;return new Promise((function(i,n){var o=a.apply(e,t);function l(e){s(o,i,n,l,r,"next",e)}function r(e){s(o,i,n,l,r,"throw",e)}l(void 0)}))});return function(e){return d.apply(this,arguments)}}()}},558209:function(e,t,i){i.d(t,{ZP:function(){return Je},Tr:function(){return Ge},aU:function(){return Ye}});var n=i(76911),o=i(506979),l=i(898781),a=i(773285),s=i(908390),r=i(515198),d=function(e){var t=e.isAdsOnlyPin,i=e.isStoryPin,o=(0,l.ZP)(),d=(0,a.F)().checkExperiment,c=i&&d("web_sce_idea_pin_edit").anyEnabled;return(0,r.jsx)(s.xu,{children:c?(0,r.jsxs)(s.xu,{display:"flex",paddingY:2,children:[(0,r.jsx)(s.rs,{disabled:!0,id:"ads-only-pin-status-switch",onChange:function(){},switched:t}),(0,r.jsxs)(s.xu,{alignItems:"stretch",display:"flex",direction:"column",justifyContent:"start",paddingX:2,children:[(0,r.jsx)(s.xu,{marginBottom:2,children:(0,r.jsx)(s.xv,{children:o._('Ad-only', 'Text for ad-only status on a pin in pin edit form', 'editPinModal.adsOnlySwitch.columnText')})}),(0,r.jsx)(s.xu,{"data-test-id":"ads-only-pin-switch",children:(0,r.jsx)(s.__,{htmlFor:"ads-only-pin-status-switch",children:(0,r.jsx)(s.xv,{color:"subtle",size:"200",children:o._('Ad-only Pins don\'t distribute an organic Pin and can\'t be saved by people who see them.', 'Explains what an ad-only pin is in pin edit modal', 'editPinModal.adsOnlySwitch.labelText')})})})]})]}):(0,r.jsxs)(n.Fragment,{children:[(0,r.jsx)(s.iz,{}),(0,r.jsxs)(s.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:6,children:[(0,r.jsx)(s.xu,{column:12,mdColumn:3,paddingY:2,children:(0,r.jsx)(s.xv,{size:"200",children:o._('Ad-only', 'Text for ad-only status on a pin in pin edit form', 'editPinModal.adsOnlySwitch.columnText')})}),(0,r.jsx)(s.xu,{column:12,mdColumn:8,children:(0,r.jsxs)(s.xu,{alignItems:"center","data-test-id":"ads-only-pin-switch",display:"flex",paddingY:1,children:[(0,r.jsx)(s.rs,{disabled:!0,id:"ads-only-pin-status-switch",onChange:function(){},switched:t}),(0,r.jsx)(s.xu,{paddingX:2,children:(0,r.jsx)(s.__,{htmlFor:"ads-only-pin-status-switch",children:(0,r.jsx)(s.xv,{size:"200",color:"subtle",children:o._('Ad-only Pins don\u2019t distribute an organic Pin and can\u2019t be saved by people who see them.', 'Explains what an ad-only pin is in pin edit modal', 'editPinModal.adsOnlySwitch.labelText')})})})]})})]})]})})},c=i(174709),u=i(766119),h=i(375322),p=i(41233),_=i(678881),g=i.n(_);function f(e){var t=e.commentsDisabled,i=e.isStoryPin,o=e.isManagedView,d=e.isNoTitle,c=e.onCommentChange,u=e.onPhotoChange,h=e.photosDisabled,p=(0,l.ZP)(),_=(0,a.F)().checkExperiment,g=i&&_("web_sce_idea_pin_edit").anyEnabled,f=o?6:d?0:3;return(0,r.jsx)(s.xu,{children:g?(0,r.jsxs)(s.xu,{display:"flex",paddingY:2,children:[(0,r.jsx)(s.rs,{id:"CommentSwitch",onChange:c,switched:!t}),(0,r.jsx)(s.xu,{"data-test-id":"allow-comments-switch",paddingX:2,children:(0,r.jsx)(s.__,{htmlFor:"CommentSwitch",children:(0,r.jsx)(s.xv,{children:p._('Allow people to comment', 'Label for toggling comments on a pin in pin edit form', 'Label for toggling comments on a pin in pin edit form')})})})]}):(0,r.jsxs)(n.Fragment,{children:[!d&&(0,r.jsx)(s.iz,{}),(0,r.jsxs)(s.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:o?0:4,paddingY:f,children:[!o&&!d&&(0,r.jsx)(s.xu,{column:12,mdColumn:3,paddingY:2,children:(0,r.jsx)(s.xv,{size:"200",children:p._('Comment Permissions', 'Label for comments setting on a pin in pin edit form', 'Label for comments setting on a pin in pin edit form')})}),(0,r.jsxs)(s.xu,{column:12,mdColumn:o?12:8,children:[(0,r.jsxs)(s.xu,{paddingY:1,display:"flex",alignItems:"center","data-test-id":"allow-comments-switch",children:[(0,r.jsx)(s.rs,{onChange:c,id:"CommentSwitch",switched:!t}),(0,r.jsx)(s.xu,{paddingX:2,children:(0,r.jsx)(s.__,{htmlFor:"CommentSwitch",children:(0,r.jsx)(s.xv,{size:"200",children:p._('Allow people to comment', 'Label for toggling comments on a pin in pin edit form', 'Label for toggling comments on a pin in pin edit form')})})})]}),u&&(0,r.jsxs)(s.xu,{paddingY:1,alignItems:"center",display:"flex",children:[(0,r.jsx)(s.rs,{onChange:u,id:"PhotoSwitch",switched:!h}),(0,r.jsx)(s.xu,{paddingX:2,children:(0,r.jsx)(s.__,{htmlFor:"PhotoSwitch",children:(0,r.jsx)(s.xv,{size:"200",children:p._('Allow people to upload photos', 'Label for toggling photos on a pin in pin edit form', 'Label for toggling photos on a pin in pin edit form')})})})]})]})]})]})})}var m=i(27255),x=i(597830),v=i(653498),b=i.n(v),y=i(121151),P=i(274495),j=i(941646),C=i(499128),w=i(343341);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function z(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?A(Object(i),!0).forEach((function(t){B(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):A(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=M(e);if(t){var o=M(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return I(this,i)}}function I(e,t){if(t&&("object"===S(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return O(e)}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(l,e);var t,i,n,o=T(l);function l(){var e;D(this,l);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return B(O(e=o.call.apply(o,[this].concat(i))),"state",{deleting:!1}),B(O(e),"unmounted",!1),B(O(e),"handleConfirm",(function(){if(!e.state.deleting){var t=e.props.onDeletePin;e.setState({deleting:!0}),t().then((function(){return e.handleDeleteDidComplete()})).catch((function(t){return e.handleDeleteDidComplete(t)}))}})),B(O(e),"handleDeleteDidComplete",(function(t){var i=e.props.toastManagerContext;e.unmounted||e.setState({deleting:!1}),t||i.showToast((function(t){var i=t.hideToast;return(0,r.jsx)(C.ZP,{onHide:i,text:e.props.i18n._('Pin deleted!', 'User deleted their pin', 'User deleted their pin')})}))})),e}return t=l,(i=[{key:"componentWillUnmount",value:function(){this.unmounted=!0}},{key:"render",value:function(){var e=this.props,t=e.i18n,i=e.onDismiss,n=e.showStoryPinCreatorDeleteMessage,o=this.state.deleting;return(0,r.jsx)(y.ZP,{heading:t._('Are you sure?', 'Confirm the user wants to delete the pin', 'Confirm the user wants to delete the pin'),accessibilityModalLabel:t._('Are you sure you want to delete this pin?', 'Accessible label to confirm the user wants to delete the pin', 'Accessible label to confirm the user wants to delete the pin'),size:"sm",onDismiss:i,footer:(0,r.jsxs)(s.xu,{display:"flex",justifyContent:"center",marginStart:-1,marginEnd:-1,children:[(0,r.jsx)(s.xu,{paddingX:1,children:(0,r.jsx)(s.zx,{fullWidth:!0,onClick:i,text:t._('Cancel', ' - ', ' -- ')})}),(0,r.jsx)(s.xu,{paddingX:1,children:(0,r.jsx)(j.Z,{id:"confirm-delete-pin",children:(0,r.jsx)(P.Z,{onClick:this.handleConfirm,text:t._('Delete', 'PinEditModal.DeletePinConfirmation.DeleteButton', 'Delete button to delete a Pin'),submitting:o})})})]}),children:(0,r.jsx)(s.xu,{padding:4,display:"flex",justifyContent:"center",children:(0,r.jsx)(s.xv,{children:n?t._('If you delete this Pin, it\'ll be gone for good and those who\'ve saved it won\'t be able to view it.', 'PinEditModal.DeletePinConfirmation', 'Confirmation to delete a Pin that lets the creator know it will be unavailable to other Pinners who have saved it'):t._('Once you delete a Pin, you can\'t undo it!', ' - ', ' -- ')})})})}}])&&k(t.prototype,i),n&&k(t,n),l}(n.PureComponent);function L(e){var t=(0,l.ZP)();return(0,r.jsx)(R,z(z({},e),{},{i18n:t,toastManagerContext:(0,w.F9)()}))}function F(e){var t=e.canEdit,i=e.onAltTextChange,o=e.altText,a=(0,l.ZP)();return(0,r.jsxs)(n.Fragment,{children:[(0,r.jsx)(s.iz,{}),(0,r.jsxs)(s.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,r.jsx)(s.xu,{column:12,mdColumn:3,paddingY:2,children:(0,r.jsx)(s.__,{htmlFor:"AltTextField",children:(0,r.jsx)(s.xv,{size:"200",children:a._('Alt text', 'EditPinModal.EditAltText', 'Label for editing alt text of pin')})})}),(0,r.jsx)(s.xu,{column:12,mdColumn:8,children:t?(0,r.jsxs)(n.Fragment,{children:[(0,r.jsx)(s.xu,{children:(0,r.jsx)(s.nv,{id:"AltTextField",onChange:function(e){var t=e.value;return i({value:t.slice(0,500)})},size:"lg",value:o||""})}),(0,r.jsx)(s.xu,{children:(0,r.jsx)(s.__,{htmlFor:"AltTextField",children:(0,r.jsx)(s.xu,{marginTop:1,children:(0,r.jsx)(s.xv,{size:"200",color:"subtle",children:a._('This helps people using screen readers understand what your Pin is about.', 'EditPinModal.EditAltText', 'Label for editing alt text of pin')})})})})]}):(0,r.jsx)(s.xu,{column:12,mdColumn:8,paddingY:2,children:(0,r.jsx)(s.xv,{size:"200",weight:"bold",children:o})})})]})]})}var U=i(998744),N=i(638767),Z=i(356725),V=i(239062),Y=i(876371);function X(e){var t,i=e.isCarousel,n=e.onMouseEnter,o=e.onMouseLeave,l=e.shouldShowCarouselSliders,a=e.onCarouselSlide,d=e.currentIndex,c=e.carouselData,u=e.pinId,h=e.description,p=e.image,_=void 0===p?{}:p;return(0,r.jsxs)(s.xu,{paddingX:4,paddingY:3,children:[i&&(t=c&&c.carousel_slots&&c.carousel_slots.length||1,t>=2&&(0,r.jsx)(s.xu,{padding:2,children:(0,r.jsx)(s.__,{htmlFor:"CardsIndex",children:(0,r.jsxs)(s.xv,{size:"200",children:[d+1,"/",t]})})})),(0,r.jsx)(s.zd,{width:236,children:(0,r.jsxs)(s.xu,{onMouseEnter:n,onMouseLeave:o,children:[(0,r.jsxs)(s.zd,{rounding:2,wash:!0,children:[i&&l&&(0,r.jsx)(s.xu,{display:"inlineBlock",height:"100%",position:"absolute",width:"100%",zIndex:new s.Ry(10),dangerouslySetInlineStyle:{__style:{background:"rgba(0, 0, 0, 0.3)"}},children:(0,r.jsx)(V.default,{handleCarouselSwipe:a,carouselIndex:d,carouselData:c,pinId:u,isEditMode:!0})}),i?(0,r.jsx)(Y.Z,{carouselIndex:d,isCloseup:!1,carouselData:c,pinId:u,isEditMode:!0}):(0,r.jsx)(s.Ee,{alt:h,color:"#efefef",naturalHeight:_.height,src:_.url,naturalWidth:_.width})]}),i&&(0,r.jsx)(Z.default,{carouselIndex:d,carouselData:c,pinId:u,handleCarouselSwipe:a,isEditMode:!0,variant:"legacy"})]})})]})}var H=i(43898);function K(e){var t=e.apiErrorMessage,i=e.shouldShowGenericUpdateError,n=e.onClickDeleteButton,o=e.disableDelete,a=e.onHide,d=e.shouldDisableSave,c=e.triggerBoardAndSectionCreate,u=(0,l.ZP)();return(0,r.jsxs)(s.xu,{display:"flex",justifyContent:"between",marginStart:-1,marginEnd:-1,children:[(0,r.jsx)(j.Z,{id:"delete-pin-button",children:(0,r.jsx)(s.zx,{fullWidth:!0,text:u._('Delete', 'EditPinModal.EditPinFooter.Delete', 'delete pin'),onClick:n,disabled:o})}),i&&(0,r.jsx)(s.xu,{display:"flex",marginStart:2,marginTop:2,justifyContent:"center",children:(0,r.jsx)(H.Z,{errorMessage:t||u._('Sorry! There was an error editing your Pin.', 'EditPinModal.EditPinFooter.ErrorMessageToast', 'Toast for pin edit error'),htmlFor:"pin-edit-generic-error"})}),(0,r.jsxs)(s.xu,{display:"flex",justifyContent:"between",marginStart:-2,marginEnd:-2,children:[(0,r.jsx)(s.xu,{paddingX:2,children:(0,r.jsx)(s.zx,{fullWidth:!0,text:u._('Cancel', 'EditPinModal.EditPinFooter.Cancel', 'cancel changes'),onClick:a})}),(0,r.jsx)(s.xu,{paddingX:2,"data-test-id":"edit-pin-save",children:(0,r.jsx)(s.zx,{fullWidth:!0,text:u._('Save', 'EditPinModal.EditPinFooter.Save', 'save changes'),color:"red",onClick:c,disabled:d})})]})]})}function G(e){var t=e.pinNoteText,i=e.isCollaborative,o=e.onPinNoteChange,a=(0,l.ZP)();return(0,r.jsxs)(n.Fragment,{children:[(0,r.jsx)(s.iz,{}),(0,r.jsxs)(s.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,r.jsx)(s.xu,{column:12,mdColumn:3,paddingY:2,children:(0,r.jsx)(s.__,{htmlFor:"PinNoteField",children:(0,r.jsx)(s.xv,{size:"200",children:i?a._('Note to group', 'editPinModal.editPinNote.groupTitle', 'Label for editing private note on group Pin'):a._('Note to self', 'editPinModal.editPinNote.title', 'Label for editing private note on Pin')})})}),(0,r.jsx)(s.xu,{column:12,mdColumn:8,paddingY:2,"data-test-id":"note-to-self-input",children:(0,r.jsx)(s.Kx,{errorMessage:t.length>=500?a._('Character limit reached', 'editPinModal.editPinNote.warningText', 'Text to inform user they have reached the length limit on Pin note'):void 0,id:"PinNoteField",onChange:o,placeholder:a._('Add a private note to remember your ideas about this Pin', 'editPinModal.editPinNote.placeholderText', 'Placeholder for editing private note'),value:t})})]})]})}function W(e){var t=e.disableDelete,i=e.onClickDeleteButton,n=e.shouldDisableSave,o=e.triggerBoardAndSectionCreate,a=(0,l.ZP)();return(0,r.jsx)(s.kC,{justifyContent:"end",children:(0,r.jsxs)(s.hE,{children:[(0,r.jsx)(s.zx,{color:"gray",disabled:t,onClick:i,size:"lg",text:a._('Delete', 'ideaPinCloseup.editPinSheet.deletePinButton', 'Button to delete the Idea Pin')}),(0,r.jsx)(s.zx,{color:"red",disabled:n,onClick:o,size:"lg",text:a._('Save', 'ideaPinCloseup.editPinSheet.savePinButton', 'Button to apply the edited changes to an Idea Pin')})]})})}var J,Q=i(381595),q=i(268883),$=i(299335),ee=i(146754),te=i(77675),ie=i(947599),ne=i(704217),oe=void 0!==J?J:J=i(337148);function le(e){var t,i,o=e.isStoryPin,d=e.onShoppingRecChange,c=e.shoppingRecDisabled,u=e.storyPinData,h=(0,l.ZP)(),p=(0,a.F)().checkExperiment,_=o&&p("web_sce_idea_pin_edit").anyEnabled,g=(0,ne.useLazyLoadQuery)(oe,{});if(!g)return null;var f=(u||{}).has_product_pins,m=null===(t=g.v3GetCurrentUserHandlerQuery)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.ipStelaRecDisabled;return(0,r.jsx)(n.Fragment,{children:_?(0,r.jsx)(n.Fragment,{children:(0,r.jsxs)(s.xu,{display:"flex",paddingY:2,children:[(0,r.jsx)(s.rs,{onChange:d,id:"stelaSwitch",switched:!c,disabled:m||f}),(0,r.jsx)(s.xu,{paddingX:2,children:(0,r.jsx)(s.kC,{alignItems:"start",justifyContent:"start",children:(0,r.jsx)(s.__,{htmlFor:"stelaSwitch",children:(0,r.jsxs)(s.kC,{alignItems:"stretch",justifyContent:"start",direction:"column",children:[(0,r.jsx)(s.xu,{marginBottom:2,children:(0,r.jsx)(s.xv,{children:h._('Show shopping recommendations', 'shopping.editor.recommendations', 'Heading for shopping recommendations permissions')})}),m?(0,r.jsxs)(n.Fragment,{children:[(0,r.jsx)(s.xv,{color:"subtle",size:"200",children:h._('You\'ve disabled shopping recommendations for your profile', 'ideaPin.editor.disable', 'Text indicating shopping recommendations are currently disabled')}),(0,r.jsx)(s.xv,{inline:!0,size:"200",weight:"bold",color:"subtle",children:(0,r.jsx)(s.rU,{display:"inlineBlock",href:"/settings/permissions",underline:"hover",children:h._('Edit profile settings', 'ideaPin.editor.link', 'Link to the settings page to enable shopping recommendations on idea pins')})})]}):(0,r.jsxs)(s.xu,{display:"flex",direction:"column",marginTop:1,children:[(0,r.jsx)(s.xu,{marginBottom:1,children:(0,r.jsx)(s.xv,{size:"200",children:h._('People can shop products similar to what\'s shown in this Idea Pin using visual search', 'ideaPin.editor.enable', 'Text indicating shopping recommendations are currently enabled')})}),(0,r.jsx)(s.xv,{size:"200",children:h._('Shopping recommendations aren\'t available for Idea ads and Idea Pins with product tags or paid partnership label', 'ideaPin.editor.tagged.unavailable', 'Explanation about how stela on idea pins with tagged products arent available')})]})]})})})})]})}):(0,r.jsx)(n.Fragment,{children:(0,r.jsxs)(s.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,children:[(0,r.jsx)(s.xu,{column:12,mdColumn:3,paddingY:2,children:(0,r.jsx)(s.xv,{size:"200",children:h._('Shopping recommendations', 'Heading for shopping recommendations permissions', 'shopping.recommendations')})}),(0,r.jsx)(s.xu,{column:12,mdColumn:8,children:(0,r.jsxs)(s.xu,{paddingY:1,display:"flex",alignItems:"start",children:[(0,r.jsx)(s.rs,{onChange:d,id:"PhotoSwitch",switched:!c,disabled:m||f}),(0,r.jsx)(s.xu,{paddingX:2,children:(0,r.jsx)(s.__,{htmlFor:"stelaSwitch",children:(0,r.jsxs)(s.kC,{alignItems:"stretch",justifyContent:"start",direction:"column",children:[(0,r.jsx)(s.xv,{size:"200",color:m?"subtle":"default",children:h._('Show similar products ', 'Label to toggle similar products on ideal pin', 'ideaPin.stela.toggle')}),m?(0,r.jsxs)(s.xv,{color:"subtle",size:"200",children:[h._('You\u2019ve disabled shopping recommendations for your profile ', 'Text indicating shopping recommendations are currently disabled', 'ideaPin.disable'),(0,r.jsx)(s.xv,{inline:!0,size:"200",weight:"bold",color:"subtle",children:(0,r.jsx)(s.rU,{display:"inlineBlock",href:"https://www.pinterest.com/settings/permissions",target:"blank",rel:"nofollow",underline:"hover",children:h._('Edit profile settings', 'Link to the settings page to enable shopping recommendations on idea pins', 'ideaPin.link')})})]}):(0,r.jsxs)(s.xu,{display:"flex",direction:"column",marginTop:1,children:[(0,r.jsx)(s.xu,{marginBottom:1,children:(0,r.jsx)(s.xv,{size:"200",children:h._('People can shop products similar to what\u2019s shown in this Idea Pin using visual search', 'Text indicating shopping recommendations are currently enabled', 'ideaPin.enable')})}),(0,r.jsx)(s.xv,{size:"200",children:h._('Shopping recommendations aren\u2019t available for Idea ads and Idea Pins with product tags or paid partnership label', 'Explanation about how stela on idea pins with tagged products arent available', 'ideaPin.tagged.unavailable')})]})]})})})]})})]})})})}function ae(e){var t=e.shoppingRecDisabled,i=e.onShoppingRecChange,o=e.isNoTitle,a=(0,l.ZP)();return(0,r.jsxs)(n.Fragment,{children:[!o&&(0,r.jsx)(s.iz,{}),(0,r.jsxs)(s.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:o?0:3,children:[!o&&(0,r.jsx)(s.xu,{column:12,mdColumn:3,paddingY:2,children:(0,r.jsx)(s.xv,{size:"200",children:a._('Recommendations', 'EditPinModal.recommendations', 'Title of a section in the edit pin modal to manage recommendations on a specific pin.')})}),(0,r.jsx)(s.xu,{column:12,mdColumn:8,children:(0,r.jsxs)(s.xu,{paddingY:1,display:"flex",alignItems:"center",children:[(0,r.jsx)(s.rs,{onChange:i,id:"ShoppingRecSwitch",switched:!t}),(0,r.jsx)(s.xu,{paddingX:2,children:(0,r.jsx)(s.__,{htmlFor:"ShoppingRecSwitch",children:(0,r.jsx)(s.xv,{size:"200",children:a._('Show shopping recommendations', 'EditPinModal.recommendations.showShoppingRecommendations.label', 'Label for toggling showing shopping recommendations on a specific pin.')})})})]})})]})]})}var se=i(259608),re=i(717615),de=i(916062),ce=i(784590),ue=i(19121),he=i(251557),pe=i(422946),_e=i(977558),ge=i(956800),fe=i(482567),me=i(90326),xe=i(407043),ve=i(825067),be=i(780280),ye=i(214494),Pe=i(827896),je=i(254176),Ce=i(947729),we=i(231947),Se=i(821463),Ae=i(678638),ze=i(414327),De=i(134906),ke=i(563339),Ee=i(609500);function Te(e){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ie(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Oe(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(i),!0).forEach((function(t){Ze(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ie(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Be(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ne(e);if(t){var o=Ne(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Fe(this,i)}}function Fe(e,t){if(t&&("object"===Te(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ue(e)}function Ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ne(e){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ze(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ve(e){return Boolean(e&&e.trim().length)}function Ye(e,t){var i=Ve(e),n=Ve(t);return(i||n)&&e!==t}function Xe(e,t){return!!t||e}var He=new s.H3([new s.Ry(_e.fe)]),Ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Re(e,t)}(a,e);var t,i,o,l=Le(a);function a(){var e,t,i,n,o,s,r,d,c,u,h,p,_,f,v,y,P,j,C,w,S,A,z,D;Me(this,a);for(var k=arguments.length,E=new Array(k),T=0;T<k;T++)E[T]=arguments[T];return Ze(Ue(D=l.call.apply(l,[this].concat(E))),"state",{altText:(null===(e=D.props.pinResource.data)||void 0===e?void 0:e.alt_text)||"",board:(null===(t=D.props.pinResource.data)||void 0===t?void 0:t.board)||null,commentsDisabled:(null===(i=D.props.pinResource.data)||void 0===i?void 0:i.comments_disabled)||(null===(n=D.props.pinResource.data)||void 0===n?void 0:n.did_it_disabled)||!1,description:(null===(o=D.props.pinResource.data)||void 0===o||null===(s=o.description)||void 0===s?void 0:s.trim())||"",apiErrorMessage:null,ideaPinDetails:D.props.isStoryPin?(0,ee.Z)(null===(r=D.props.pinResource.data)||void 0===r||null===(d=r.story_pin_data)||void 0===d?void 0:d.metadata):{},link:(null===(c=D.props.pinResource.data)||void 0===c?void 0:c.link)||"",pinNoteText:(null===(u=D.props.pinResource.data)||void 0===u||null===(h=u.pin_note)||void 0===h?void 0:h.text)||"",sectionId:(null===(p=D.props.pinResource.data)||void 0===p||null===(_=p.section)||void 0===_?void 0:_.id)||null,sectionName:(null===(f=D.props.pinResource.data)||void 0===f||null===(v=f.section)||void 0===v?void 0:v.title)||null,showDeleteConfirmation:!1,showOptions:!1,carousel_data:(null===(y=D.props.pinResource.data)||void 0===y?void 0:y.carousel_data)||null,title:(null===(P=D.props.pinResource.data)||void 0===P?void 0:P.title)||"",isLoadingPin:!Boolean(D.props.pinResource.isLoaded),isProcessing:!1,currentIndex:void 0!==D.props.carouselSlotCurrentIndex?D.props.carouselSlotCurrentIndex:(null===(j=D.props.pinResource.data)||void 0===j||null===(C=j.carousel_data)||void 0===C?void 0:C.index)||0,selectedTemplate:D.props.isStoryPin?(0,te.Z)(null===(w=D.props.pinResource.data)||void 0===w||null===(S=w.story_pin_data)||void 0===S?void 0:S.metadata):"none",shoppingRecDisabled:null===(A=D.props.pinResource.data)||void 0===A?void 0:A.shopping_rec_disabled,shouldApplyTextToAll:!1,shouldDisableSave:!1,shouldShowCarouselSliders:!1,shouldShowValidationTitleError:!1,shouldShowValidationDescriptionError:!1,shouldShowValidationLinkFormatError:!1,shouldShowGenericUpdateError:!1,shouldShowValidationUserMentionTagsError:!1,userMentionTags:(null===(z=D.props.pinResource.data)||void 0===z?void 0:z.user_mention_tags)||[]}),Ze(Ue(D),"onClickDeleteButton",(function(){return D.setState({showDeleteConfirmation:!0})})),Ze(Ue(D),"onHideConfirmation",(function(){return D.setState({showDeleteConfirmation:!1})})),Ze(Ue(D),"updateCarouselSlotIndex",(function(){var e=D.props.carouselSlotCurrentIndex;D.setState({currentIndex:void 0!==e?e:D.props.pinResource.data&&D.props.pinResource.data.carousel_data&&D.props.pinResource.data.carousel_data.index||0})})),Ze(Ue(D),"handleBoardChange",(function(e){var t=D.state.board.id;e.id!==t&&D.setState({board:e,sectionId:null,sectionName:null})})),Ze(Ue(D),"createBoard",(function(e){var t=D.props,i=t.createBoard,n=t.viewer,o=t.orbacActingAs,l=D.state.board,a=(0,we.lJ)(n,o);!l.id&&l.name&&e&&i(l.name,e,a).then((function(e){if(D._isMounted){var t=D.state,i=t.sectionId,n=t.sectionName;!i&&n?(D.setState({board:e}),D.createSection()):(D.handleBoardChange(e),D.handleSave())}}))})),Ze(Ue(D),"handleBoardCreateClick",(function(e){if(e){var t={name:e,privacy:m.Z.BoardPrivacy.PUBLIC,access:"write"};D.setState({board:t,sectionId:null,sectionName:null})}})),Ze(Ue(D),"createSection",(function(){var e=D.state,t=e.board,i=e.sectionName,n=D.props,o=n.viewer,l=n.orbacActingAs,a=(0,we.lJ)(o,l);if(i)if(t.id){var s={boardId:t.id,name:i};(0,D.props.createSection)(s,a).then((function(e){D._isMounted&&(D.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null}),D.handleSave())})).catch((function(){D.setState({shouldShowGenericUpdateError:!0,apiErrorMessage:null})}))}else D.createBoard()})),Ze(Ue(D),"handleSectionCreateClick",(function(e){0!==e.length&&(D.state.board&&D.setState({sectionId:null,sectionName:e}))})),Ze(Ue(D),"handleToggleOptions",(function(){D.setState((function(e){return{showOptions:!e.showOptions}}))})),Ze(Ue(D),"handleSectionChange",(function(e){return D.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null,shouldShowGenericUpdateError:!1})})),Ze(Ue(D),"handleDeletePin",(function(){var e=D.props,t=e.advertiser_id,i=e.changeBoardPinCount,n=e.changeUserPinCount,o=e.dispatch,l=e.getClientTrackingParams,a=e.onDelete,s=e.onHide,r=e.orbacActingAs,d=e.pinId,c=e.pinResource.data,u=e.removeBoardlessPin,h=e.viewer,p=(0,we.lJ)(h,r),_=Oe(Oe(Oe({},t?{advertiser_id:t}:{}),p?{orbac_subject_id:p}:Object.freeze({})),{},{id:d,client_tracking_params:l(d)});return ye.Z.create("PinResource",_).callDelete().then((function(){if(D._isMounted){if(!c)return;var e=c.board,t=(e=void 0===e?{}:e).id,l=c.pinner,r=(l=void 0===l?{}:l).id,p=c.section,_=null==p?void 0:p.id;i({boardId:t,sectionId:_,increment:-1}),n({userId:r,increment:-1}),o((0,je.xQ)(t)),o((0,ge.EX)({feedId:_||t,feedType:_?pe.DV.BOARD_SECTION_PINS:pe.DV.BOARDFEED,itemIds:[d],itemType:"pin"})),o((0,ge.EX)({feedId:r,feedType:pe.DV.STORY_PINS_FEED,itemIds:[d],itemType:"pin"})),o((0,ge.EX)({feedId:r,feedType:pe.DV.PROFILE_PINS_FEED,itemIds:[d],itemType:"pin"})),_&&o((0,Ae.CE)(_)),s(),a&&a()}h.id&&u(h.id,d)}))})),Ze(Ue(D),"sanitizeCarouselData",(function(e){var t=D.state.carousel_data;if(e&&(t=e),t){var i=t.carousel_slots;if(i){var n={carousel_slots:[]};return i.forEach((function(e){var t={description:e.details||"",title:e.title||"",link:e.link||""};n.carousel_slots.push(t)})),n}}return null})),Ze(Ue(D),"triggerBoardAndSectionCreate",(function(e){return function(){var t=D.state,i=t.board,n=t.sectionId,o=t.sectionName;i&&!i.id&&i.name?D.createBoard(e):!n&&o?D.createSection():D.handleSave()}})),Ze(Ue(D),"logPinEditEvent",(function(e,t,i,n,o){var l={},a=D.props,s=a.pinId,r=a.view,d=a.viewParameter,c=D.state.userMentionTags;if(l.objectId=s,l.num_user_mention_tags=c.length,e&&(l.board_was_modified=!0),!e&&t&&(l.board_section_was_modified=!0),i){var u=D.state.description,h=o.description;l.original_pin_description=h,l.edited_pin_description=u}if(n){var p=D.state.carousel_data,_=o.carousel_data;l.original_carousel_data=JSON.stringify(D.sanitizeCarouselData(_)),l.edited_carousel_data=JSON.stringify(D.sanitizeCarouselData(p))}D.props.logContextEvent({event_type:2,component:208,view_type:r,view_parameter:d,aux_data:Oe({},l)})})),Ze(Ue(D),"handleSave",(function(){var e;D.setState({apiErrorMessage:null,isProcessing:!0});var t=D.props,i=t.advertiser_id,n=t.completeResourceFetch,o=t.invalidatePinResource,l=t.isStoryPin,a=t.onHide,s=t.orbacActingAs,r=t.pinId,d=t.pinResource.data,c=t.removeBoardlessPin,u=t.updatePinNote,h=t.viewer;if(d){var p,_=d.alt_text,g=d.board,f=d.carousel_data,m=d.comments_disabled,v=d.description,y=d.did_it_disabled,P=d.link,j=d.pin_note,C=d.section,w=d.shopping_rec_disabled,S=d.story_pin_data,A=d.title,z=null==j?void 0:j.text,k=(null==S||null===(e=S.metadata)||void 0===e?void 0:e.template_type)||"none",E=D.state,T=E.carousel_data,I=E.shouldShowValidationLinkFormatError;if(T){var O=D.sanitizeCarouselData();O&&(p=JSON.stringify(O))}var M=D.state,B=M.altText,R=M.board,L=M.carousel_data,F=M.commentsDisabled,U=M.currentIndex,N=M.description,Z=M.ideaPinDetails,V=M.pinNoteText,Y=M.sectionId,X=M.selectedTemplate,H=M.shoppingRecDisabled,K=M.title,G=M.userMentionTags,W=R||g,J=l&&{idea_pin_details:Z&&X&&Z[X]&&JSON.stringify((0,he.F)(Z[X])),idea_pin_details_template_type:X&&(0,x.Z)(X)},Q=I?P:D.state.link,q=(0,we.lJ)(h,s),$=Oe(Oe(Oe({alt_text:B,board_id:null==W?void 0:W.id,board_section_id:Y,carousel_data_json:p,description:N,disable_comments:F,disable_did_it:F,id:r,link:Q,shopping_rec_disabled:H,title:K,user_mention_tags:JSON.stringify(G)},i?{advertiser_id:i}:{}),q?{orbac_subject_id:q}:Object.freeze({})),l?J:{}),ee=C&&C.id||null,te=null==W?void 0:W.id,ie=null==g?void 0:g.id,ne=Ye(_,B),oe=ie!==te,le=(Boolean(ee)||Boolean(Y))&&ee!==Y,ae=Ye(A,K),se=Ye(v,N),re=Ye(P,Q),de=Boolean(L)&&Boolean(f)&&!b()(L,f),ce=m!==F||y!==F,ue=Ye(z,V);ne||oe||le||ae||se||ue||re||de||ce||w!==H||k!==X?(ue&&u(r,z,V,q),ye.Z.create("PinResource",$).callUpdate().then((function(e){if(D._isMounted){var t,i,l,s=D.props,r=s.changeBoardPinCount,u=s.onSubmit,p=s.pinId,_=s.pinMoved;if((oe||le)&&te&&ie)_({selectedPinIds:[p],source:{boardId:ie,sectionId:ee},target:{boardId:te,sectionId:Y}}),r({boardId:te,sectionId:Y||void 0,increment:1}),r({boardId:ie,sectionId:ee||void 0,increment:-1}),h.id&&"quick_saves"===(null===(i=d.board)||void 0===i?void 0:i.layout)&&c(h.id,p);if(u&&te&&null!=W&&W.url)u({boardId:te,title:null!==(l=W.name)&&void 0!==l?l:"",sectionId:Y,url:W.url});a(),o(p,q),null!==(t=e.resource_response)&&void 0!==t&&t.data.carousel_data&&(e.resource_response.data.carousel_data.index=U),n(e,q),D.logPinEditEvent(oe,le,se,de,d)}})).catch((function(){var e=D.state,t=e.shouldShowValidationTitleError,i=e.shouldShowValidationDescriptionError,n=e.shouldShowValidationLinkFormatError;D.setState({isProcessing:!1,shouldShowGenericUpdateError:!t&&!i&&!n})}))):(a(),o(r,q)),D.setState({isProcessing:!1})}})),Ze(Ue(D),"handleTextChanges",(function(e,t){var i=D.state.carousel_data;if(i){var n=g()(i),o=n.carousel_slots,l=void 0===o?[]:o,a=D.state,s=a.currentIndex,r=a.shouldApplyTextToAll,d=a.description,c=a.link,u=a.title,h=D.valueIsValidForType(e,t);switch(r?l.forEach((function(i){return i[t]=e})):l[s]&&(l[s][t]=e),t){case"details":var p=0===s?e:d;D.setState({description:p,carousel_data:n||null,shouldShowValidationDescriptionError:!h,shouldShowGenericUpdateError:!1});break;case"link":var _=0===s?e:c;D.setState({link:_,carousel_data:n||null,shouldShowValidationLinkFormatError:!h,shouldShowGenericUpdateError:!1});break;case"title":var f=0===s?e:u;D.setState({title:f,carousel_data:n||null,shouldShowValidationTitleError:!h,shouldShowGenericUpdateError:!1})}}})),Ze(Ue(D),"handleDescriptionChange",(function(e){var t=e.value,i=e.userMentionTags,n=D.valueIsValidForType(t,"description"),o=i.length<=5;i.length<D.state.userMentionTags.length&&D.props.logContextEvent({event_type:8906,element:116,aux_data:{tag_type:1}}),D.setState({description:t,userMentionTags:i,shouldShowValidationDescriptionError:!n,shouldShowValidationUserMentionTagsError:!o,shouldShowGenericUpdateError:!1})})),Ze(Ue(D),"handleCarouselDetailsChange",(function(e){var t=e.value;D.handleTextChanges(t,"details")})),Ze(Ue(D),"handleTitleChange",(function(e){var t=e.value,i=D.valueIsValidForType(t,"title");D.setState({title:t,shouldShowValidationTitleError:!i,shouldShowGenericUpdateError:!1})})),Ze(Ue(D),"handleCarouselTitleChange",(function(e){var t=e.value;D.handleTextChanges(t,"title")})),Ze(Ue(D),"handleAltTextChange",(function(e){var t=e.value;D.setState({altText:t})})),Ze(Ue(D),"valueIsValidForType",(function(e,t){switch(t){case"details":case"description":return e.length<=500;case"link":return e.length>=0&&0===(0,De.FU)([(0,De.Jx)({message:D.props.i18n._('Not a valid url.', 'Validation error for an improperly formated url', 'Validation error for an improperly formated url')})],e).length;case"title":return e.length<=100;default:return!0}})),Ze(Ue(D),"handleWebsiteChange",(function(e){var t=e.value,i=D.valueIsValidForType(t,"link");D.setState({link:t,shouldDisableSave:!i,shouldShowValidationLinkFormatError:!i,shouldShowGenericUpdateError:!1})})),Ze(Ue(D),"handleCarouselWebsiteChange",(function(e){var t=e.value;D.handleTextChanges(t,"link")})),Ze(Ue(D),"handleCommentChange",(function(e){return D.setState({commentsDisabled:!e.value})})),Ze(Ue(D),"handleShoppingRecChange",(function(e){D.setState({shoppingRecDisabled:!e.value})})),Ze(Ue(D),"handleShouldApplyToAll",(function(e){if(e){var t=D.state,i=t.currentIndex,n=void 0===i?0:i,o=t.carousel_data;if(!o)return;var l=g()(o),a=l.carousel_slots,s=void 0===a?[]:a,r=s[n],d=r.details,c=r.link,u=r.title;s.forEach((function(e){e.details=d,e.title=u,e.link=c})),D.setState({carousel_data:l,shouldApplyTextToAll:e})}else D.setState({shouldApplyTextToAll:e})})),Ze(Ue(D),"handleCarouselSlider",(function(e){var t=D.state.carousel_data,i=t&&t.carousel_slots&&t.carousel_slots.length||1;e>=0&&e<i&&D.setState({currentIndex:e})})),Ze(Ue(D),"handleMouseEnter",(function(){D.setState({shouldShowCarouselSliders:!0})})),Ze(Ue(D),"handleMouseLeave",(function(){D.setState({shouldShowCarouselSliders:!1})})),Ze(Ue(D),"handleTemplateSelect",(function(e){var t=D.state.ideaPinDetails;t&&t[e]?D.setState({selectedTemplate:e}):D.setState({ideaPinDetails:Oe(Oe({},t),{},Ze({},e,{listBlocks:[],keyValueBlocks:{}})),selectedTemplate:e})})),Ze(Ue(D),"handleUpdateListBlocks",(function(e){var t=D.state,i=t.ideaPinDetails,n=t.selectedTemplate;if(n&&i){var o=i[n]||{};D.setState({ideaPinDetails:Oe(Oe({},i),{},Ze({},n,Oe(Oe({},o),{},{listBlocks:e})))})}})),Ze(Ue(D),"handleUpdateKeyValueBlocks",(function(e){var t=D.state,i=t.ideaPinDetails,n=t.selectedTemplate;if(n&&i){var o=i[n]||{};D.setState({ideaPinDetails:Oe(Oe({},i),{},Ze({},n,Oe(Oe({},o),{},{keyValueBlocks:e})))})}})),D}return t=a,(i=[{key:"componentDidMount",value:function(){this._isMounted=!0,this.updateCarouselSlotIndex()}},{key:"componentDidUpdate",value:function(e){var t=this.props,i=t.carouselSlotCurrentIndex,n=t.isStoryPin,o=t.pinResource,l=o.data,a=o.isLoaded;if(l&&a!==e.pinResource.isLoaded){var s=l.story_pin_data,r=l.alt_text,d=l.board,c=l.comments_disabled,u=l.did_it_disabled,h=l.description,p=l.link,_=l.pin_note,g=l.section,f=l.shopping_rec_disabled,m=l.title,x=l.user_mention_tags,v=(s||{}).metadata;this.setState({altText:r,board:d,commentsDisabled:c||u,description:h&&h.trim(),isLoadingPin:!1,ideaPinDetails:n&&v?(0,ee.Z)(v):null,link:p,pinNoteText:(null==_?void 0:_.text)||"",sectionId:(g||{}).id,sectionName:(g||{}).title,selectedTemplate:n&&v?(0,te.Z)(v):null,title:m,carousel_data:l.carousel_data,currentIndex:void 0!==i?i:l.carousel_data&&l.carousel_data.index||0,shouldApplyTextToAll:!1,userMentionTags:x||[],shoppingRecDisabled:f})}}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"getCurrentUserId",value:function(e){return e.isAuth?e.id:""}},{key:"render",value:function(){var e,t,i,o,l,a=this,_=this.props,g=_.checkExperiment,m=_.disableDelete,x=_.isAdsOnlyPinCreationEnabled,v=_.isStoryPin,b=_.isViewerBoardOwnerAndAdvertiser,P=_.onHide,j=_.orbacActingAs,C=_.pinId,w=_.pinResource,S=_.viewer,A=this.state,z=A.altText,D=A.apiErrorMessage,k=A.board,E=A.carousel_data,T=A.commentsDisabled,I=A.currentIndex,O=A.description,M=A.ideaPinDetails,B=A.isLoadingPin,R=A.isProcessing,Z=A.link,V=A.pinNoteText,Y=A.sectionId,H=A.sectionName,J=A.selectedTemplate,ee=A.shoppingRecDisabled,te=A.shouldApplyTextToAll,ne=A.shouldDisableSave,oe=A.shouldShowCarouselSliders,re=A.shouldShowGenericUpdateError,de=A.shouldShowValidationDescriptionError,ce=A.shouldShowValidationLinkFormatError,ue=A.shouldShowValidationTitleError,he=A.shouldShowValidationUserMentionTagsError,pe=A.showDeleteConfirmation,_e=A.showOptions,ge=A.title,fe=A.userMentionTags,me=w.data||{};if(!w.data)return null;var xe=(null===(e=me.native_creator)||void 0===e?void 0:e.id)===this.getCurrentUserId(S);if(pe)return(0,r.jsx)(L,{onDeletePin:this.handleDeletePin,onDismiss:this.onHideConfirmation,showStoryPinCreatorDeleteMessage:v&&xe});var ve=!!(E&&E.carousel_slots&&E.carousel_slots.length>1),be=E&&E.carousel_slots&&E.carousel_slots.length>0&&E.carousel_slots[I]||{},ye=be.details,Pe=void 0===ye?"":ye,je=be.link,Se=void 0===je?"":je,Ae=be.title,ze=void 0===Ae?"":Ae,De=(0,we.KY)(S,k,j),ke=me&&(me.access||[]).includes("write")||this.props.canEdit||!!k&&(0,p.Z)({action:4,board:k,viewer:S})||!!k&&De,Ee=function(e){var t=(0,we.lJ)(e,j),i=t||a.getCurrentUserId(e),n=a.props.canEdit&&a.props.accountAdvertiserOwnerUserId?a.props.accountAdvertiserOwnerUserId:i;return ke&&!me.is_repin&&!v&&(ve||!E)&&(me.native_creator&&me.native_creator.id===n||ve&&me.pinner&&me.pinner.id===n||me.link_domain&&me.link_domain.official_user&&me.link_domain.official_user.id===n||!!me.domain&&me.pinner&&me.pinner.id===n&&me.pinner.domain_url&&me.pinner.domain_url.includes(me.domain))}(S),Te=Ee&&!(me.aggregated_pin_data&&me.aggregated_pin_data.is_shop_the_look),Ie=function(){return de?(0,Ce.MM)(ve,a.props.i18n):he?(0,Ce.bl)(ve,a.props.i18n):""},Oe=me&&me.images&&me.images["474x"]||{},Me=v&&!!me.story_pin_data&&xe,Be=Ee?(0,r.jsx)(q.Z,{canEdit:ke,onTitleChange:ve?this.handleCarouselTitleChange:this.handleTitleChange,title:ve&&ze?ze:ge,errorMessage:ue?(0,Ce.Y8)(ve,this.props.i18n):""}):null,Re=(ke||S.isAuth&&(me.pinner||{}).id===S.id)&&Ee?(0,r.jsx)(N.Z,{canAddUserMentionTags:!ve,canEdit:ke,description:(ve?Pe:O)||"",errorMessage:Ie(),initialMentions:fe,label:this.props.i18n._('Description', 'Label for editing description', 'Label for editing description'),placeholder:this.props.i18n._('Tell us about this Pin...', 'Placeholder for editing description', 'Placeholder for editing description'),onDescriptionChange:ve?this.handleCarouselDetailsChange:this.handleDescriptionChange}):null,Le=(0,r.jsx)(G,{isCollaborative:!(null==k||!k.is_collaborative),onPinNoteChange:function(e){var t=e.value;a.setState({pinNoteText:t})},pinNoteText:V}),Fe=Te?(0,r.jsx)($.Z,{errorMessage:ce?(0,Ce.qj)(ve,this.props.i18n):"",link:ve&&Se?Se:Z,onChangeWebsite:ve?this.handleCarouselWebsiteChange:this.handleWebsiteChange}):null,Ue=ve?(0,r.jsxs)(s.xu,{display:"flex",justifyContent:"end",paddingX:4,paddingY:3,alignItems:"end",children:[(0,r.jsx)(s.xu,{paddingY:2,children:(0,r.jsx)(s.__,{htmlFor:"applyTextToAll",children:(0,r.jsx)(s.xv,{children:this.props.i18n._('Apply text to all', 'Apply title, description, link to all cards', 'Apply title, description, link to all cards')})})}),(0,r.jsx)(s.xu,{paddingX:2,paddingY:2,children:(0,r.jsx)(s.rs,{onChange:function(e){return a.handleShouldApplyToAll(e.value)},id:"applyTextToAll",switched:te})})]}):null,Ne=Ee?(0,r.jsx)(F,{canEdit:ke,onAltTextChange:this.handleAltTextChange,altText:z}):null,Ze=me.can_delete_did_it_and_comments?(0,r.jsx)(f,{commentsDisabled:T,onCommentChange:this.handleCommentChange}):null,Ve=!S.isAuth||(null===(t=me.pinner)||void 0===t?void 0:t.id)!==S.id||me.is_repin||me.story_pin_data||S.shopping_rec_disabled?null:(0,r.jsx)(ae,{shoppingRecDisabled:ee,onShoppingRecChange:this.handleShoppingRecChange}),Ye=!!(0,we.lJ)(S,j),Ke=x&&Xe(b,Ye)&&(0,r.jsx)(d,{isAdsOnlyPin:null===(i=this.props.pinResource.data)||void 0===i?void 0:i.promoted_is_removable}),Ge=!!S.has_quicksave_board&&!!S.boardCount&&S.boardCount<2&&!Ye&&!this.props.accountAdvertiserOwnerUserId,We="quick_creates"===(null===(o=me.board)||void 0===o?void 0:o.layout),Je=(0,we.Ms)(S,j),Qe=v&&g("web_sce_idea_pin_scheduling").anyEnabled&&g("web_sce_idea_pin_edit").anyEnabled,qe=v&&g("web_sc_combined_desc_details").anyEnabled,$e=M&&J&&M[J];return Qe?(0,r.jsx)(s.mh,{zIndex:He,children:(0,r.jsx)(s.To,{accessibilityDismissButtonLabel:this.props.i18n._('Dismiss button', 'closeup.editPinSheet.dismissButtonLabel', 'Accessibility Label for the dismiss button'),accessibilityLabel:this.props.i18n._('Edit Pin details', 'closeup.editPinSheet.label', 'Accessibility Label for the edit pin sheet'),footer:(0,r.jsx)(W,{onClickDeleteButton:this.onClickDeleteButton,disableDelete:!ke||m,shouldDisableSave:ne,triggerBoardAndSectionCreate:this.triggerBoardAndSectionCreate(Je)}),heading:this.props.i18n._('Edit Pin', 'closeup.editPinSheet.title', 'Heading title for Edit Pin sheet'),onDismiss:function(){return P()},children:B||!w.isLoaded||R?(0,r.jsx)(s.kC,{alignItems:"center",justifyContent:"center",children:(0,r.jsx)(s.$j,{show:!0,accessibilityLabel:this.props.i18n._('loading', 'EditPinModal.LoadingPin.Spinner', 'Accessible label for the edit pin loading icon')})}):(0,r.jsx)(s.kC,{alignItems:"stretch",justifyContent:Ge?"center":"between",children:Ge?null:(0,r.jsxs)(s.xu,{width:"100%",children:[(0,r.jsx)(q.Z,{canEdit:!0,isStoryPin:!0,errorMessage:ue?(0,Ce.Y8)(ve,this.props.i18n):"",onTitleChange:ve?this.handleCarouselTitleChange:this.handleTitleChange,title:ve&&ze?ze:ge}),qe&&(0,r.jsx)(N.Z,{canEdit:!0,isStoryPin:!0,canAddUserMentionTags:!ve,description:(ve?Pe:O)||"",errorMessage:Ie(),initialMentions:fe,label:this.props.i18n._('Description', 'editPinModal.editDescription.labelText', 'Label for editing description'),onDescriptionChange:ve?this.handleCarouselDetailsChange:this.handleDescriptionChange,placeholder:this.props.i18n._('Write a detailed description for your Pin here or add a specific list below', 'editPinModal.editDescription.labelText', 'Placeholder for editing description')}),(0,r.jsx)(s.xu,{paddingY:2,children:(0,r.jsx)(s.xv,{size:"100",children:this.props.i18n._('Details', 'storyboard.detailsList.metadataModuleSelector.title', 'Title of the idea pin metadata selector.')})}),(0,r.jsx)(se.Z,{onSelect:this.handleTemplateSelect,selectedTemplate:J,size:"sm",viewParameter:89}),"recipe"===J&&(0,r.jsx)(c.Z,{handleUpdateKeyValueBlocks:this.handleUpdateKeyValueBlocks,handleUpdateListBlocks:this.handleUpdateListBlocks,metadata:$e}),"diy"===J&&(0,r.jsx)(h.Z,{handleUpdateKeyValueBlocks:this.handleUpdateKeyValueBlocks,handleUpdateListBlocks:this.handleUpdateListBlocks,metadata:$e}),"blank"===J&&(0,r.jsx)(u.Z,{handleUpdateListBlocks:this.handleUpdateListBlocks,metadata:$e}),(0,r.jsx)($.Z,{isStoryPin:!0,link:ve&&Se?Se:Z,onChangeWebsite:this.handleWebsiteChange,errorMessage:ce?(0,Ce.qj)(ve,this.props.i18n):""}),(0,r.jsxs)(s.kC,{alignItems:"stretch",justifyContent:"start",direction:"row",children:[(0,r.jsx)(s.xu,{column:6,marginEnd:3,children:(0,r.jsx)(U.Z,{isStoryPin:!0,board:k||me.board,canEdit:ke,isOriginallyQuickCreatesBoard:We,onBoardChange:this.handleBoardChange,onBoardCreate:this.handleBoardCreateClick,viewerId:S.id||""})}),(0,r.jsx)(s.xu,{column:6,marginStart:3,children:(0,r.jsx)(Q.Z,{isStoryPin:!0,board:k||me.board,canEdit:ke,currentSection:me.section,idealDirection:"right",onSectionCreate:this.handleSectionCreateClick,onSectionChange:this.handleSectionChange,sectionId:Y,sectionName:H})})]}),(0,r.jsx)(s.xu,{paddingY:2,children:(0,r.jsx)(s.iP,{onTap:function(){return a.handleToggleOptions()},children:(0,r.jsxs)(s.kC,{alignItems:"center",gap:{row:2,column:0},children:[(0,r.jsx)(s.xv,{weight:"bold",children:this.props.i18n._('More options', 'storyboard.detailsList.metadataModule.moreOptions', 'Title of the more options section.')}),(0,r.jsx)(s.JO,{accessibilityLabel:this.props.i18n._('More options arrow icon', 'storyboard.detailsList.metadataModule.moreOptions', 'Label for the more options section.'),color:"default",icon:_e?"arrow-up":"arrow-down",size:"12"})]})})}),_e&&(0,r.jsxs)(n.Fragment,{children:[(0,r.jsx)(f,{isStoryPin:!0,commentsDisabled:T,onCommentChange:this.handleCommentChange}),x&&Xe(b,Ye)&&(0,r.jsx)(d,{isStoryPin:!0,isAdsOnlyPin:null===(l=this.props.pinResource.data)||void 0===l?void 0:l.promoted_is_removable}),Me&&(0,r.jsx)(ie.Z,{children:(0,r.jsx)(le,{isStoryPin:!0,onShoppingRecChange:this.handleShoppingRecChange,shoppingRecDisabled:ee,storyPinData:me.story_pin_data})})]})]})})})}):(0,r.jsx)(y.ZP,{heading:this.props.i18n._('Edit this Pin', 'EditPinModal.ModalHeading.EditThisPin', 'Edit a previously saved pin'),accessibilityModalLabel:this.props.i18n._('Edit your previously saved pin', 'EditPinModal.ModalHeading.AccessibleLabel', 'Accessible label for edit previously saved pin modal'),size:Ge?"sm":"lg",onDismiss:P,footer:(0,r.jsx)(K,{apiErrorMessage:D,shouldShowGenericUpdateError:re,onClickDeleteButton:this.onClickDeleteButton,disableDelete:!ke||m,onHide:P,shouldDisableSave:ne,triggerBoardAndSectionCreate:this.triggerBoardAndSectionCreate(Je)}),children:B||!w.isLoaded||R?(0,r.jsx)(s.kC,{alignItems:"center",justifyContent:"center",children:(0,r.jsx)(s.$j,{accessibilityLabel:this.props.i18n._('loading', 'EditPinModal.LoadingPin.Spinner', 'Accessible label for the edit pin loading icon'),show:!0})}):(0,r.jsxs)(s.xu,{display:"flex",justifyContent:Ge?"center":"between",minHeight:350,paddingX:4,children:[Ge?null:(0,r.jsxs)(s.xu,{column:12,mdColumn:9,children:[(0,r.jsx)(U.Z,{board:k||me.board,canEdit:ke,isOriginallyQuickCreatesBoard:We,onBoardChange:this.handleBoardChange,onBoardCreate:this.handleBoardCreateClick,viewerId:S.id||""}),(0,r.jsx)(Q.Z,{board:k||me.board,canEdit:ke,onSectionCreate:this.handleSectionCreateClick,onSectionChange:this.handleSectionChange,sectionId:Y,sectionName:H,currentSection:me.section}),Be,Re,Fe,Ue,Ne,Le,Ze,Ve,Ke,Me&&(0,r.jsx)(ie.Z,{children:(0,r.jsx)(le,{onShoppingRecChange:this.handleShoppingRecChange,shoppingRecDisabled:ee,storyPinData:me.story_pin_data})})]}),(0,r.jsx)(X,{isCarousel:ve,shouldShowCarouselSliders:oe,onCarouselSlide:this.handleCarouselSlider,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,currentIndex:this.state.currentIndex,carouselData:this.state.carousel_data,pinId:C,description:O,image:Oe})]})})}}])&&Be(t.prototype,i),o&&Be(t,o),a}(n.Component),Ge=function(e,t,i){return Oe({field_set_key:"detailed",id:e,preserve_component_state:t},i?{orbac_subject_id:i}:Object.freeze({}))},We=(0,o.connect)(null,(function(e,t){return{changeBoardPinCount:function(t){return e((0,je.Br)(t))},changeUserPinCount:function(t){return e((0,me.JS)(t))},completeResourceFetch:function(t,i){return e((0,ze.Sr)("PinResource",Ge(t.resource_response.data.id,!1,i),t))},createBoard:function(t,i,n){return e((0,je.aX)(t,i,n))},createSection:function(i,n){return e((0,Ae.vB)(i,t.i18n,n))},invalidatePinResource:function(t,i){return e((0,ze.jB)("PinResource",Ge(t,!0,i)))},removeBoardlessPin:function(t,i){return e((0,ge.EX)({feedId:t,feedType:pe.DV.BOARDLESS_PINS,itemIds:[i],itemType:"pin"}))},pinMoved:(0,Se.bindActionCreators)(ke.S,e),updatePinNote:function(t,i,n,o){return e((0,fe._)(t,i,n,o))}}}))(Ke);function Je(e){var t,i,n,s,d,c=(0,l.ZP)(),u=(0,xe.v)().logContextEvent,h=(0,a.F)().checkExperiment,p=h("ads_only_pin_creation",{dangerouslySkipActivation:!0}).anyEnabled,_=(0,o.useSelector)((function(e){return e.advertiser})),g=null===(t=(0,ve.W)())||void 0===t?void 0:t.onPinDelete,f=(0,re.Z)(),m=(0,ue.Z)(),x=(0,be.B)().advertiser,v=(0,we.lJ)(m,f),b=(0,ce.Z)({name:"PinResource",options:Ge(e.pinId,!0,v)}),y=(0,Pe.Z)(),P=m.isAuth&&Boolean(_)?_.id:void 0,j=m.isAuth&&Boolean(_)&&_.owner_user_id!==m.id?_.owner_user_id:void 0,C=(0,de.Z)(b.data),w=Boolean((null==x?void 0:x.owner_user_id)===m.id),S=Boolean((null===(i=b.data)||void 0===i||null===(n=i.board)||void 0===n||null===(s=n.owner)||void 0===s?void 0:s.id)===m.id),A=!(null===(d=b.data)||void 0===d||!d.story_pin_data_id||!b.data.story_pin_data);return(0,r.jsx)(We,Oe(Oe({},e),{},{advertiser_id:P,accountAdvertiserOwnerUserId:j,checkExperiment:h,getClientTrackingParams:y,dispatch:(0,o.useDispatch)(),history:(0,Ee.useHistory)(),i18n:c,isAdsOnlyPinCreationEnabled:p,isStoryPin:A,isViewerBoardOwnerAndAdvertiser:w&&S,logContextEvent:u,onDelete:function(){var t;C(),null===(t=e.onDelete)||void 0===t||t.call(e),g&&g({pinId:e.pinId})},orbacActingAs:f,pinResource:b,viewer:m}))}},947729:function(e,t,i){function n(e,t){return e?t._('Title too long. Make sure all cards\' titles have less than 100 characters', 'Title entered is too long while editing a carousel pin and/or one of its pins', 'Title entered is too long while editing a carousel pin and/or one of its pins'):t._('Title too long. Make sure title has less than 100 characters', 'Title entered is too long while editing a pin', 'Title entered is too long while editing a pin')}function o(e,t){return e?t._('Description too long. Make sure all cards\' descriptions have less than 500 characters', 'Description entered is too long while editing a carousel pin and/or one of its pins', 'Description entered is too long while editing a carousel pin and/or one of its pins'):t._('Description too long. Make sure description has less than 500 characters', 'Description entered is too long while editing a pin', 'Description entered is too long while editing a pin')}function l(e,t){return t._('Too many mentions. Make sure you have at most 5.', 'editPinModal.errorMessages.userMentionOverLimit', 'Too many mentions used in the description')}function a(e,t){return e?t._('Need to provide a valid URL. Make sure all cards\' links are valid', 'Invalid URL/link provided while editing a carousel pin and/or one of its pins', 'Invalid URL/link provided while editing a carousel pin and/or one of its pins'):t._('Need to provide a valid URL. Make sure the link is valid', 'Invalid URL/link provided while editing a pin', 'Invalid URL/link provided while editing a pin')}i.d(t,{MM:function(){return o},Y8:function(){return n},bl:function(){return l},qj:function(){return a}})}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/58209-c6d6e418e66f6154.js.map